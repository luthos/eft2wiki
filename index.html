<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>eft2wiki</title>

    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <style>
      textarea { width: 100%; height: 180pt; }
    </style>
    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

  </head>

  <body>

    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="#">eft2wiki</a>
          <span class="navbar-text"> by Luthos</span>
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span4">
          <div class="accordion">

            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" href="#boxEFT">
                  Paste EFT textblock here:
                </a>
              </div>
              <div class="accordion-body collapse" id="boxEFT">
                <div class="accordion-inner">
                  (ctrl-v)<br>
                  <textarea id="pastearea" autofocus></textarea>
                </div>
              </div>
            </div>

            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" href="#boxDebug">
                  Debugging info
                </a>
              </div>
              <div style="height:0;" class="accordion-body collapse in" id="boxDebug">
                <div class="accordion-inner">
                  <textarea id="debugarea" readonly></textarea>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="span4">
          <div class="accordion">

            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" href="#boxPreview">
                  Preview
                </a>
              </div>
              <div class="accordion-body collapse" id="boxPreview">
                <div class="accordion-inner">
                  <div id="previewarea"></div>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="span4">
          <div class="accordion">

            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" href="#boxMediawiki">
                  MediaWiki code 
                </a>
              </div>
              <div class="accordion-body collapse" id="boxMediawiki">
                <div class="accordion-inner">
                  (right click, copy)<br>
                  <textarea id="mediawiki" readonly onClick="this.focus(); this.select();"></textarea>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/bootstrap-transition.js"></script>
    <script src="assets/js/bootstrap-collapse.js"></script>
    <script>$(".collapse").collapse()</script>

    <script src="eftparser.js"></script>
    <script src="render.js"></script>
    <script>
function modified() {
  // Attempt to parse the EFT block
  var ast = parseEFT($("#pastearea")[0].value);
  // TODO: we should have some mechanism of failure here
   
  // Update the views of this parse. Debug first in case there are errors later
  $("#debugarea")[0].value = JSON.stringify(ast, null, 4);
  $("#mediawiki")[0].value = makeMediaWiki(ast);
  $("#previewarea")[0].innerHTML = makeHTML(ast);
   
  // Err, the preview box may need resizing. Sigh.
  // Why must people use fixed blah blah blah whatever.
  var previewBox = $('#boxPreview');
  if(previewBox.hasClass('in')) {
    previewBox.collapse('reset');
  }
}
$('#pastearea').change(modified).keyup(modified);
if($('#pastearea')[0].value !== "") {
  modified();
}
    </script>
  </body>
</html>
